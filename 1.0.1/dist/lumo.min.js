document.addEventListener("DOMContentLoaded",()=>{const ANIMATION_DURATION=300;const animateModal=(dialog,direction,onFinish)=>{const body=dialog.querySelector("section");const isOpening=direction==="open";const options={duration:ANIMATION_DURATION,easing:"ease"};const opacity=new Animation(new KeyframeEffect(dialog,[{opacity:isOpening?0:1},{opacity:isOpening?1:0}],options),document.timeline);const transform=new Animation(new KeyframeEffect(body,[{transform:`translateY(${isOpening ? "-3rem" : "0"})`},{transform:`translateY(${isOpening ? 0 : "-3rem"})`}],options),document.timeline);opacity.play();transform.play();if(!isOpening){opacity.onfinish=()=>{dialog.close();onFinish?.()}}};const closeModal=(modal,cb)=>animateModal(modal,"close",cb);const openModal=(modal)=>{modal.setAttribute("open","open");animateModal(modal,"open")};document.addEventListener("click",(e)=>{const target=e.target;const openTrigger=target.closest("[data-target]");const closeTrigger=target.closest("[data-close]");const currentModal=document.querySelector("dialog[open]");if(openTrigger){e.preventDefault();const modalToOpen=document.getElementById(openTrigger.dataset.target);if(!modalToOpen)return;if(currentModal&&currentModal!==modalToOpen){closeModal(currentModal,()=>openModal(modalToOpen))}else if(!currentModal){openModal(modalToOpen)}
return}
if(currentModal){const isBackdrop=target===currentModal;const isLocked=currentModal.hasAttribute("data-locked");if(closeTrigger||(isBackdrop&&!isLocked))closeModal(currentModal);}
if(!target.closest("details.dropdown[open]")){document.querySelectorAll("details.dropdown[open]").forEach((d)=>d.removeAttribute("open"))}
const navToggle=target.closest("nav button[role='menu'], nav button[aria-label='close']");if(navToggle){const nav=navToggle.closest("nav");const list=nav?.querySelector("ul");if(list){const isHidden=!list.style.display||list.style.display==="none";list.style.display=isHidden?"flex":"none"}}});document.addEventListener("keydown",(e)=>{if(e.key==="Escape"){const modal=document.querySelector("dialog[open]");if(modal&&!modal.hasAttribute("data-locked"))closeModal(modal);}});document.querySelectorAll("article.tabs").forEach((el)=>{const tabs=el.querySelectorAll('[role="tab"]');const panels=el.querySelectorAll('[role="tabpanel"]');tabs.forEach((tab,i)=>{tab.addEventListener("click",()=>{tabs.forEach((t)=>t.setAttribute("aria-selected","false"));panels.forEach((p)=>p.setAttribute("hidden",""));tab.setAttribute("aria-selected","true");panels[i].removeAttribute("hidden")});tab.addEventListener("keydown",(e)=>{let index;if(e.key==="ArrowRight")index=(i+1)%tabs.length;else if(e.key==="ArrowLeft")index=(i-1+tabs.length)%tabs.length;else if(e.key==="Home")index=0;else if(e.key==="End")index=tabs.length-1;else return;e.preventDefault();tabs[index].focus();tabs[index].click()})})});document.querySelectorAll('[aria-roledescription="carousel"]').forEach((carousel)=>{const figure=carousel.querySelector('figure[role="group"]');const slides=figure.querySelectorAll('[aria-roledescription="slide"]');const nextBtn=carousel.querySelector("[data-next]");const prevBtn=carousel.querySelector("[data-prev]");let currentIndex=0;let list=carousel.querySelector('[role="tablist"]');if(!list){list=document.createElement("ol");list.setAttribute("role","tablist");slides.forEach((_,i)=>{const btn=document.createElement("button");btn.setAttribute("role","tab");btn.setAttribute("aria-label",`Slide ${i + 1}`);const li=document.createElement("li");li.append(btn);list.append(li)});carousel.append(list)}
const indicators=list.querySelectorAll('[role="tab"]');const updateCarousel=(index)=>{currentIndex=Math.max(0,Math.min(index,slides.length-1));figure.style.transform=`translateX(-${currentIndex * 100}%)`;indicators.forEach((btn,i)=>{const active=i===currentIndex;btn.setAttribute("aria-selected",active);btn.tabIndex=active?0:-1});if(prevBtn)prevBtn.disabled=currentIndex===0;if(nextBtn)nextBtn.disabled=currentIndex===slides.length-1};indicators.forEach((btn,i)=>{btn.addEventListener("click",()=>updateCarousel(i))});carousel.addEventListener("keydown",(e)=>{if(e.key==="ArrowRight")updateCarousel(currentIndex+1);else if(e.key==="ArrowLeft")updateCarousel(currentIndex-1);});nextBtn?.addEventListener("click",()=>updateCarousel(currentIndex+1));prevBtn?.addEventListener("click",()=>updateCarousel(currentIndex-1));const zBase=parseInt(getComputedStyle(carousel).zIndex)||0;carousel.querySelectorAll("[data-prev],[data-next]").forEach((b)=>(b.style.zIndex=zBase+1));updateCarousel(0)})})