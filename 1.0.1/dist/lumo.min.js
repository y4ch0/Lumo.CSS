document.addEventListener("DOMContentLoaded",()=>{const ANIMATION_DURATION=300;let currentModal=null;let previousFocus=null;const animateModal=(dialog,direction,onFinish)=>{const body=dialog.querySelector("section");const isOpening=direction==="open";const options={duration:ANIMATION_DURATION,easing:"ease"};const opacity=new Animation(new KeyframeEffect(dialog,[{opacity:isOpening?0:1},{opacity:isOpening?1:0}],options),document.timeline);const transform=new Animation(new KeyframeEffect(body,[{transform:`translateY(${isOpening ? "-3rem" : "0"})`},{transform:`translateY(${isOpening ? 0 : "-3rem"})`}],options),document.timeline);opacity.play();transform.play();if(!isOpening){opacity.onfinish=()=>{dialog.close();onFinish?.()}}};const getFocusableElements=(container)=>{const selectors='a[href], button:not([disabled]), textarea:not([disabled]), input:not([disabled]), select:not([disabled]), [tabindex]:not([tabindex="-1"])';return Array.from(container.querySelectorAll(selectors))};const trapFocus=(e,modal)=>{if(e.key!=="Tab")return;const focusableElements=getFocusableElements(modal);if(focusableElements.length===0){e.preventDefault();return}
const firstElement=focusableElements[0];const lastElement=focusableElements[focusableElements.length-1];if(e.shiftKey&&document.activeElement===firstElement){e.preventDefault();lastElement.focus()}else if(!e.shiftKey&&document.activeElement===lastElement){e.preventDefault();firstElement.focus()}};const setSiblingsAriaHidden=(modal,hidden)=>{const siblings=Array.from(document.body.children).filter((child)=>child!==modal&&child.tagName!=="SCRIPT");siblings.forEach((sibling)=>{if(hidden){if(!sibling.hasAttribute("aria-hidden")){sibling.setAttribute("aria-hidden","true");sibling.setAttribute("data-aria-hidden-by-modal","true")}}else{if(sibling.hasAttribute("data-aria-hidden-by-modal")){sibling.removeAttribute("aria-hidden");sibling.removeAttribute("data-aria-hidden-by-modal")}}})};const closeModal=(modal,cb)=>{if(!modal)return;modal.removeEventListener("keydown",modal._focusTrapHandler);animateModal(modal,"close",()=>{modal.removeAttribute("role");modal.removeAttribute("aria-modal");setSiblingsAriaHidden(modal,!1);if(previousFocus&&typeof previousFocus.focus==="function"){previousFocus.focus()}
previousFocus=null;currentModal=null;cb?.()})};const openModal=(modal)=>{if(!modal)return;previousFocus=document.activeElement;modal.setAttribute("open","open");modal.setAttribute("role","dialog");modal.setAttribute("aria-modal","true");setSiblingsAriaHidden(modal,!0);animateModal(modal,"open");const focusableElements=getFocusableElements(modal);if(focusableElements.length>0){focusableElements[0].focus()}else{modal.setAttribute("tabindex","-1");modal.focus()}
modal._focusTrapHandler=(e)=>{if(e.key==="Tab"){trapFocus(e,modal)}else if(e.key==="Escape"&&!modal.hasAttribute("data-locked")){e.preventDefault();closeModal(modal)}};modal.addEventListener("keydown",modal._focusTrapHandler);currentModal=modal};document.addEventListener("click",(e)=>{const target=e.target;const openTrigger=target.closest("[data-target]");const closeTrigger=target.closest("[data-close]");const openedModal=document.querySelector("dialog[open]");if(openTrigger){e.preventDefault();const modalId=openTrigger.dataset.target;const modalToOpen=document.getElementById(modalId);if(!modalToOpen)return;openTrigger.setAttribute("aria-controls",modalId);openTrigger.setAttribute("aria-haspopup","dialog");if(openedModal&&openedModal!==modalToOpen){closeModal(openedModal,()=>openModal(modalToOpen))}else if(!openedModal){openModal(modalToOpen)}
return}
if(openedModal){const isBackdrop=target===openedModal;const isLocked=openedModal.hasAttribute("data-locked");if(closeTrigger||(isBackdrop&&!isLocked)){closeModal(openedModal)}}
if(!target.closest("details.dropdown[open]")){document.querySelectorAll("details.dropdown[open]").forEach((d)=>d.removeAttribute("open"))}
const navToggle=target.closest("nav button[role='menu'], nav button[aria-label='close']");if(navToggle){const nav=navToggle.closest("nav");const list=nav?.querySelector("ul");if(list){const isHidden=!list.style.display||list.style.display==="none";list.style.display=isHidden?"flex":"none";navToggle.setAttribute("aria-expanded",isHidden)}}});document.addEventListener("keydown",(e)=>{if(e.key==="Escape"){const modal=document.querySelector("dialog[open]");if(modal&&!modal.hasAttribute("data-locked")){closeModal(modal)}}});document.querySelectorAll("article.tabs").forEach((el)=>{const tabs=el.querySelectorAll('[role="tab"]');const panels=el.querySelectorAll('[role="tabpanel"]');tabs.forEach((tab,i)=>{const panel=panels[i];if(!tab.id){tab.id=`tab-${Math.random().toString(36).substr(2, 9)}`}
if(!panel.id){panel.id=`panel-${Math.random().toString(36).substr(2, 9)}`}
if(!tab.hasAttribute("aria-controls")){tab.setAttribute("aria-controls",panel.id)}
if(!panel.hasAttribute("aria-labelledby")){panel.setAttribute("aria-labelledby",tab.id)}
tab.addEventListener("click",()=>{tabs.forEach((t)=>{t.setAttribute("aria-selected","false");t.tabIndex=-1});panels.forEach((p)=>p.setAttribute("hidden",""));tab.setAttribute("aria-selected","true");tab.tabIndex=0;panels[i].removeAttribute("hidden")});tab.addEventListener("keydown",(e)=>{let index;if(e.key==="ArrowRight")index=(i+1)%tabs.length;else if(e.key==="ArrowLeft")index=(i-1+tabs.length)%tabs.length;else if(e.key==="Home")index=0;else if(e.key==="End")index=tabs.length-1;else return;e.preventDefault();tabs[index].focus();tabs[index].click()})})});document.querySelectorAll('[aria-roledescription="carousel"]').forEach((carousel)=>{const figure=carousel.querySelector('figure[role="group"]');const slides=figure.querySelectorAll('[aria-roledescription="slide"]');const nextBtn=carousel.querySelector("[data-next]");const prevBtn=carousel.querySelector("[data-prev]");let currentIndex=0;carousel.setAttribute("aria-label",carousel.getAttribute("aria-label")||"Carousel");let list=carousel.querySelector('[role="tablist"]');if(!list){list=document.createElement("ol");list.setAttribute("role","tablist");list.setAttribute("aria-label","Carousel slides");slides.forEach((_,i)=>{const btn=document.createElement("button");btn.setAttribute("role","tab");btn.setAttribute("aria-label",`Slide ${i + 1}`);const li=document.createElement("li");li.append(btn);list.append(li)});carousel.append(list)}
const indicators=list.querySelectorAll('[role="tab"]');const liveRegion=document.createElement("div");liveRegion.setAttribute("aria-live","polite");liveRegion.setAttribute("aria-atomic","true");liveRegion.className="sr-only";liveRegion.style.cssText="position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border-width:0;";carousel.appendChild(liveRegion);if(nextBtn)nextBtn.setAttribute("aria-label",nextBtn.getAttribute("aria-label")||"Next slide");if(prevBtn)prevBtn.setAttribute("aria-label",prevBtn.getAttribute("aria-label")||"Previous slide");const updateCarousel=(index)=>{currentIndex=Math.max(0,Math.min(index,slides.length-1));figure.style.transform=`translateX(-${currentIndex * 100}%)`;indicators.forEach((btn,i)=>{const active=i===currentIndex;btn.setAttribute("aria-selected",active);btn.tabIndex=active?0:-1});slides.forEach((slide,i)=>{if(i===currentIndex){slide.removeAttribute("aria-hidden");slide.removeAttribute("inert")}else{slide.setAttribute("aria-hidden","true");slide.setAttribute("inert","")}});if(prevBtn)prevBtn.disabled=currentIndex===0;if(nextBtn)nextBtn.disabled=currentIndex===slides.length-1;liveRegion.textContent=`Slide ${currentIndex + 1} of ${slides.length}`};indicators.forEach((btn,i)=>{btn.addEventListener("click",()=>updateCarousel(i))});carousel.addEventListener("keydown",(e)=>{if(e.key==="ArrowRight"){e.preventDefault();updateCarousel(currentIndex+1)}else if(e.key==="ArrowLeft"){e.preventDefault();updateCarousel(currentIndex-1)}else if(e.key==="Home"){e.preventDefault();updateCarousel(0)}else if(e.key==="End"){e.preventDefault();updateCarousel(slides.length-1)}});nextBtn?.addEventListener("click",()=>updateCarousel(currentIndex+1));prevBtn?.addEventListener("click",()=>updateCarousel(currentIndex-1));const zBase=parseInt(getComputedStyle(carousel).zIndex)||0;carousel.querySelectorAll("[data-prev],[data-next]").forEach((b)=>(b.style.zIndex=zBase+1));updateCarousel(0)});document.querySelectorAll("details.dropdown").forEach((dropdown)=>{const summary=dropdown.querySelector("summary");if(summary){summary.setAttribute("aria-haspopup","true");summary.setAttribute("aria-expanded",dropdown.hasAttribute("open"));dropdown.addEventListener("toggle",()=>{summary.setAttribute("aria-expanded",dropdown.hasAttribute("open"))})}})})